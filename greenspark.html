<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>GreenSpark Inventory</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Google Fonts (optional) -->
  <link rel="preconnect" href="https://fonts.gstatic.com" />
  <link
    href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&display=swap"
    rel="stylesheet"
  />

  <!-- Bootstrap CSS (for quick styling) -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />

  <style>
    /* Basic reset */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    body {
      font-family: 'Roboto', sans-serif;
      background-color: #fafafa;
      color: #333;
    }

    /* Container for sidebar + content */
    .wrapper {
      display: flex;
      width: 100%;
      min-height: 100vh;
    }

    /* Sidebar styles */
    .sidebar {
      width: 240px;
      background-color: #fff;
      border-right: 1px solid #ddd;
      padding-top: 1rem;
    }
    .sidebar .nav-item {
      list-style: none;
      margin: 0;
    }
    .sidebar .nav-link {
      display: block;
      padding: 0.75rem 1rem;
      color: #333;
      text-decoration: none;
      transition: background-color 0.2s;
    }
    .sidebar .nav-link:hover {
      background-color: #f1f1f1;
    }
    .sidebar .nav-link i {
      margin-right: 8px;
    }
    .sidebar .nav-link.active {
      background-color: #e7f5e8; /* slight highlight for active */
      font-weight: 500;
      color: #27ae60;
    }

    /* Main content area */
    .content {
      flex: 1;
      display: flex;
      flex-direction: column;
    }

    /* Header or top area */
    .header {
      background-color: #fff;
      border-bottom: 1px solid #ddd;
      padding: 1rem;
    }
    .header h1 {
      font-size: 1.25rem;
      margin-bottom: 0.5rem;
    }

    /* Tabs (Inventory Overview, Regrades, etc.) */
    .inventory-tabs {
      display: flex;
      gap: 1rem;
      align-items: center;
      border-bottom: 1px solid #eee;
      margin-bottom: 1rem;
    }
    .inventory-tabs a {
      padding: 0.5rem;
      text-decoration: none;
      color: #333;
      border-bottom: 3px solid transparent;
      transition: border-color 0.2s;
    }
    .inventory-tabs a.active {
      color: #27ae60;
      border-bottom-color: #27ae60;
      font-weight: 500;
    }

    /* Search box styling */
    .search-bar {
      display: flex;
      justify-content: flex-start;
      align-items: center;
      margin-bottom: 1rem;
    }
    .search-bar input {
      width: 250px;
      padding: 0.5rem 0.75rem;
      margin-right: 0.75rem;
      border: 1px solid #ccc;
      border-radius: 4px;
    }

    /* Table styling */
    .table-wrap {
      background-color: #fff;
      border: 1px solid #ddd;
      border-radius: 4px;
      padding: 1rem;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 0;
    }
    th, td {
      padding: 0.75rem;
      text-align: left;
      border-bottom: 1px solid #eee;
      white-space: nowrap;
    }
    thead th {
      background-color: #f9f9f9;
      font-weight: 500;
    }
    tr:hover {
      background-color: #fefefe;
    }
    .btn-view {
      background-color: #fff;
      border: 1px solid #27ae60;
      border-radius: 4px;
      color: #27ae60;
      padding: 5px 10px;
      cursor: pointer;
      font-size: 0.875rem;
    }
    .btn-view:hover {
      background-color: #27ae60;
      color: #fff;
    }

    /* Footer or bottom spacing if desired */
    .footer {
      padding: 1rem;
      text-align: center;
      font-size: 0.875rem;
      color: #999;
    }
  </style>
</head>

<body>
  <div class="wrapper">
    <!-- SIDEBAR -->
    <div class="sidebar">
      <ul class="nav flex-column">
        <li class="nav-item">
          <a class="nav-link active" href="#">
            <i class="bi bi-table"></i> Inventory
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#"><i class="bi bi-people"></i> Customers</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#"><i class="bi bi-truck"></i> Freight</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#"><i class="bi bi-card-checklist"></i> Reports</a>
        </li>
        <!-- Add more items as needed -->
      </ul>
    </div>

    <!-- MAIN CONTENT AREA -->
    <div class="content">
      <!-- TOP HEADER -->
      <div class="header">
        <h1>Inventory</h1>
      </div>

      <!-- TABS -->
      <div class="inventory-tabs px-3">
        <a href="#" class="active">Inventory Overview</a>
        <a href="#">Regrades</a>
        <a href="#">Finished Goods</a>
        <a href="#">Packing List</a>
        <a href="#">Adjustments</a>
        <a href="#">Negative Inventory</a>
      </div>

      <!-- SEARCH BAR -->
      <div class="search-bar px-3">
        <input
          type="text"
          id="searchField"
          placeholder="Search all fields"
          oninput="filterTable()"
        >
      </div>

      <!-- MAIN TABLE WRAPPER -->
      <div class="table-wrap mx-3 mb-3">
        <table id="inventoryTable">
          <thead>
            <tr>
              <th>Commodities</th>
              <th>WIP</th>
              <th>Finished Goods</th>
              <th>Total</th>
              <th>Avg Cost</th>
              <th>Value</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <!-- Populated by JS -->
          </tbody>
        </table>
      </div>

      <!-- FOOTER (optional) -->
      <div class="footer">
        GreenSpark Inventory Page (updates every 5 minutes)
      </div>
    </div>
  </div>

  <!-- HIDDEN JSON for the combined layout to fetch -->
  <script id="greenspark-data" type="application/json">
    {}
  </script>

  <!-- Bootstrap icons (optional) -->
  <script
    src="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.js"
    defer
  ></script>
  <!-- Bootstrap JS (optional) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    /********************************************************
     * 1) 25× INVENTORY DATA FROM YOUR ORIGINAL
     ********************************************************/
    let inventoryData = [
      {
        commodity: "WASTE",
        wip: 29353500,       // 1,174,140 * 25
        finishedGoods: 0,
        avgCost: -0.0335,
        value: -983342.25    // -39333.69 * 25
      },
      {
        commodity: "ALUMINUM",
        wip: 236575,         // 9,463 * 25
        finishedGoods: 48425, // 1,937 * 25
        avgCost: 0.3886,
        value: 110757.75     // 4430.31 * 25
      },
      {
        commodity: "Electric Motors",
        wip: 110700,         // 4,428 * 25
        finishedGoods: 0,
        avgCost: 0.289,
        value: 32075.5       // 1283.02 * 25
      },
      {
        commodity: "Insulated copper wire",
        wip: 1521075,        // 60,843 * 25
        finishedGoods: 68550, // 2,742 * 25
        avgCost: 1.1867,
        value: 1886407.5     // 75456.30 * 25
      },
      {
        commodity: "LEAD",
        wip: 53950,          // 2,158 * 25
        finishedGoods: 49150, // 1,966 * 25
        avgCost: 0.1665,
        value: 17170.5       // 686.82 * 25
      },
      {
        commodity: "FERROUS",
        wip: 10245175,       // 409,807 * 25
        finishedGoods: 0,
        avgCost: 0.0997,
        value: 1021844       // 40873.76 * 25
      },
      {
        commodity: "RADIATOR PRODUCT",
        wip: 41925,          // 1,677 * 25
        finishedGoods: 0,
        avgCost: 1.3891,
        value: 58240         // 2329.60 * 25
      },
      {
        commodity: "COPPER PRODUCT",
        wip: 466925,         // 18,677 * 25
        finishedGoods: 81525, // 3,261 * 25
        avgCost: 2.7192,
        value: 1491340       // 59653.6 * 25
      },
      {
        commodity: "BRASS PRODUCT",
        wip: 48775,          // 1,951 * 25
        finishedGoods: 0,
        avgCost: 1.7965,
        value: 87622.5       // 3504.9 * 25
      },
      {
        commodity: "MISC PRODUCT",
        wip: 68100,          // 2,724 * 25
        finishedGoods: 60100, // 2,404 * 25
        avgCost: 1.4482,
        value: 185653        // 7426.12 * 25
      },
      {
        commodity: "STAINLESS STEEL PRODUCT",
        wip: -269975,        // -10,799 * 25
        finishedGoods: 40425, // 1,617 * 25
        avgCost: 0.3059,
        value: -70210.75     // -2808.43 * 25
      },
      {
        commodity: "E-SCRAP",
        wip: -3425,          // -137 * 25
        finishedGoods: 0,
        avgCost: -0.1905,
        value: 652.5         // 26.1 * 25
      }
    ];

    /********************************************************
     * 2) FLUCTUATE DATA EVERY 5 MIN (±5% for WIP/FG/Value)
     ********************************************************/
    function fluctuateInventory() {
      inventoryData.forEach(item => {
        // WIP
        let wipFluct = (Math.random() * 10 - 5) / 100; // ±5%
        item.wip = Math.round(item.wip * (1 + wipFluct));

        // Finished Goods
        let fgFluct = (Math.random() * 10 - 5) / 100; // ±5%
        item.finishedGoods = Math.round(item.finishedGoods * (1 + fgFluct));

        // Avg Cost (±2%)
        let costFluct = (Math.random() * 4 - 2) / 100;
        item.avgCost = parseFloat((item.avgCost * (1 + costFluct)).toFixed(4));

        // Value (±5%)
        let valFluct = (Math.random() * 10 - 5) / 100;
        item.value = parseFloat((item.value * (1 + valFluct)).toFixed(2));
      });
    }

    /********************************************************
     * 3) RENDER TABLE & HIDDEN JSON
     ********************************************************/
    function renderTable() {
      const tbody = document.getElementById("inventoryTable").querySelector("tbody");
      tbody.innerHTML = "";

      inventoryData.forEach(item => {
        const wipLabel = item.wip.toLocaleString() + " lbs";
        const fgLabel = item.finishedGoods.toLocaleString() + " lbs";
        const totalNum = item.wip + item.finishedGoods;
        const totalLabel = totalNum.toLocaleString() + " lbs";

        // Format avg cost as $X.XXXX/lb
        const avgCostStr = `$${item.avgCost.toFixed(4)}/lb`;
        // Format value as $xx,xxx.xx
        const valStr = `$${item.value.toLocaleString()}`;

        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${item.commodity}</td>
          <td>${wipLabel}</td>
          <td>${fgLabel}</td>
          <td>${totalLabel}</td>
          <td>${avgCostStr}</td>
          <td>${valStr}</td>
          <td>
            <button class="btn-view">VIEW</button>
          </td>
        `;
        tbody.appendChild(row);
      });

      // Update hidden JSON for external fetch
      const dataScript = document.getElementById("greenspark-data");
      dataScript.textContent = JSON.stringify({ inventory: inventoryData });
    }

    /********************************************************
     * 4) TABLE FILTER (Search all fields)
     ********************************************************/
    function filterTable() {
      const searchVal = document.getElementById("searchField").value.toLowerCase();
      const rows = document.querySelectorAll("#inventoryTable tbody tr");
      rows.forEach(row => {
        if (row.innerText.toLowerCase().includes(searchVal)) {
          row.style.display = "";
        } else {
          row.style.display = "none";
        }
      });
    }

    /********************************************************
     * 5) INIT + AUTO-UPDATE EVERY 5 MIN
     ********************************************************/
    function init() {
      renderTable();
      setInterval(() => {
        fluctuateInventory();
        renderTable();
      }, 5 * 60 * 1000);
    }

    window.addEventListener("DOMContentLoaded", init);
  </script>
</body>
</html>
